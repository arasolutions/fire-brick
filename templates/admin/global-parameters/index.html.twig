{% extends 'admin/base.html.twig' %}


{% block title %}Les paramètres globaux{% endblock %}

{% block description %}Tous les paramètres liés à votre site{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.css') }}" rel="stylesheet">
{% endblock %}


{% block body %}
    {% if success %}
        <div class="alert alert-success">
            <strong>Parfait !</strong> Vos paramètres ont bien été mis à jour.
        </div>
    {% endif %}
    <div class="panel">
        <div class="panel-body">
            {{ form_start(form) }}


            <div class="panel panel-mint">
                <div class="panel-heading">
                    <h3 class="panel-title"><label class="control-label">Général</label></h3>
                </div>
                <div class="panel-body">
                    <div class="col-sm-12 form-group">
                        {{ form_label(form.name) }}
                        {{ form_widget(form.name, {'attr':{'class':'form-control'}}) }}
                    </div>
                    <div class="col-sm-12 form-group">
                        {{ form_label(form.description) }}
                        {{ form_widget(form.description, {'attr':{'class':'form-control'}}) }}
                    </div>
                    <div class="col-sm-12 form-group">
                        {{ form_label(form.domain) }}
                        {{ form_widget(form.domain, {'attr':{'class':'form-control'}}) }}
                    </div>
                </div>
            </div>

            <div class="panel panel-mint">
                <div class="panel-heading">
                    <h3 class="panel-title"><label class="control-label">{{ form_label(form.logo) }}</label></h3>
                </div>
                <div class="panel-body">
                    <div class="col-sm-2">
                        {% if site.logo %}
                            <img alt="Vertex" height="35"
                                 src="{{ vich_uploader_asset(site, 'logoFile') | imagine_filter('logo') }}"/>
                        {% else %}
                            <img alt="Vertex" height="35"
                                 src="{{ asset('assets/img/logo_site_default.png') }}"/>
                        {% endif %}
                    </div>
                    <div class="col-sm-10">
                        {{ form_widget(form.logo, {'attr':{'class':'form-control input-lg'}}) }}
                    </div>
                    <div class="offset-sm-2 col-sm-10">
                        <div class="checkbox">
                            {{ form_widget(form.nameInLogo, {'attr':{'class':'form-control magic-checkbox'}}) }}
                            {{ form_label(form.nameInLogo) }}
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel panel-mint">
                <div class="panel-heading">
                    <h3 class="panel-title"><label class="control-label">Réseaux sociaux</label></h3>
                </div>
                <div class="panel-body">
                    <div class="col-sm-12 form-group">
                        {{ form_label(form.facebook) }}
                        {{ form_widget(form.facebook, {'attr':{'class':'form-control'}}) }}
                    </div>

                    <div class="col-sm-12 form-group">
                        {{ form_label(form.twitter) }}
                        {{ form_widget(form.twitter, {'attr':{'class':'form-control'}}) }}
                    </div>

                    <div class="col-sm-12 form-group">
                        {{ form_label(form.instagram) }}
                        {{ form_widget(form.instagram, {'attr':{'class':'form-control'}}) }}
                    </div>
                </div>
            </div>

            <div class="panel panel-mint">
                <div class="panel-heading">
                    <h3 class="panel-title"><label class="control-label">Structure</label></h3>
                </div>
                <div class="panel-body">
                    <div class="col-sm-6">
                        <div class="col-sm-12 form-group">
                            {{ form_label(form.template) }}
                            {{ form_widget(form.template, {'attr':{'class':'form-control'}}) }}
                        </div>
                        <div class="col-sm-12 form-group">
                            {{ form_label(form.colorTheme) }}
                            {{ form_widget(form.colorTheme) }}
                        </div>
                        <div class="col-sm-12 form-group">
                            {{ form_label(form.lightTheme) }}
                            {{ form_widget(form.lightTheme, {'attr':{'class':'form-control'}}) }}
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <img id="dynamic-theme" src="" width="100%"/>
                    </div>

                </div>
            </div>

            <div class="col-sm-12 form-group">
                <button class="btn btn-success pull-right" type="submit">
                    Enregistrer
                </button>
            </div>
            {{ form_end(form) }}
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js') }}"></script>
    <script src="{{ asset('bundles/colorpicker/js/jqColorPicker.min.js') }}"></script>
    <script type="text/javascript">
        $('.colorpicker:not(.expert)').colorPicker({
            opacity: false
        });

        function changeSrc(){
            var light = $('#edit_global_parameters_lightTheme').val() === "1" ? 'light' : 'dark';
            $('#dynamic-theme').attr('src',"/templates/template-" + $('#edit_global_parameters_template').val() + "/options/" + light + ".png");
            $('#dynamic-theme').css('backgroundColor', $('#edit_global_parameters_colorTheme').val());
        }

        $(document).ready(function () {
            $('#edit_global_parameters_template, #edit_global_parameters_lightTheme').on('change', function(){
                changeSrc();
            });

            $('#edit_global_parameters_colorTheme').on('blur', function(){
                changeSrc();
            })
        });

        changeSrc();
    </script>

{% endblock %}